#include QMK_KEYBOARD_H

extern keymap_config_t keymap_config;

#define _COLEMAK 0
#define _GAMING 1
#define _LOWER 2
// #define _NAV 3

enum custom_keycodes {
  COLEMAK = SAFE_RANGE,
  GAMING,
  LOWER,
};

// Aliases
// MOD_ prefix for MT(MOD, kc)
// KH_ prefix for Hold toggle
// KD_ prefix for Tapdance

#define KC_HESC LT(_LOWER, KC_ESC)
#define MOD_Z MT(MOD_LCTL, KC_Z)
#define MOD_X MT(MOD_LALT, KC_X)
#define MOD_BSPC MT(MOD_LSFT, KC_BSPC)
#define MOD_SPC MT(MOD_RSFT, KC_SPC)
#define KC_DLSFT TD(TD_LSFT)
#define KC_HBSPC LT(_LOWER, KC_BSPC)
#define KC_SSPC MT(MOD_LSFT, KC_SPC)
#define KC_TGUI MT(MOD_LGUI, KC_TAB)

// Define tapdance
enum {
  TD_LSFT = 0,
  SINGLE_TAP_SPACE = 1,
};

/* enum combos { */
/*   NT_ESC */
/* }; */
/*  */
/* const uint16_t PROGMEM nt_combo[] = {KC_N, KC_T, COMBO_END}; */
/*  */
/* combo_t key_combos[COMBO_COUNT] = { */
/*   [NT_ESC] = COMBO(nt_combo, KC_ESC) */
/* }; */

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {

  [_COLEMAK] = LAYOUT_kc(
  // * MOD DH variant
  //┌─────┬─────┬─────┬─────┬─────┬─────┐                ┌─────┬─────┬─────┬─────┬─────┬─────┐
     EQL,  1,    2,    3,    4,    5,                     6,    7,    8,    9,    0,    MINUS,
  //├─────┼─────┼─────┼─────┼─────┼─────┤                ├─────┼─────┼─────┼─────┼─────┼─────┤
     TAB,  Q,    W,    F,    P,    B,                     J,    L,    U,    Y,    SCLN, BSLASH,
  //├─────┼─────┼─────┼─────┼─────┼─────┤                ├─────┼─────┼─────┼─────┼─────┼─────┤
     HESC, A,    R,    S,    T,    G,                     K,    N,    E,    I,    O,    QUOT,
  //├─────┼─────┼─────┼─────┼─────┼─────┼─────┐    ┌─────┼─────┼─────┼─────┼─────┼─────┼─────┤
     DLSFT,Z,   X,     C,    D,    V,    LSFT,     DEL,  M,    H,    COMM, DOT,  SLSH, RSFT,
  //└─────┴─────┴─────┴─┬───┴──┬──┴──┬──┴──┬──┘    └───┬─┴──┬──┴─┬───┴─┬───┴─────┴─────┴─────┘
                         LCTL,  HBSPC,TGUI,             ENT, SSPC, LALT
  //                    └──────┴─────┴─────┘           └────┴────┴─────┘
  ),

  [_LOWER] = LAYOUT_kc(
  //┌─────┬─────┬─────┬─────┬─────┬─────┐                    ┌─────┬─────┬─────┬─────┬─────┬─────┐
     F12,  F1,   F2,   F3,   F4,   F5,                        F6,   F7,   F8,   F9,   F10,  F11,
  //├─────┼─────┼─────┼─────┼─────┼─────┤                    ├─────┼─────┼─────┼─────┼─────┼─────┤
     TRNS, EXLM, AT,   LCBR, RCBR, PIPE,                      UP,   7,    8,    9,    LBRC, _VOLUP,
  //├─────┼─────┼─────┼─────┼─────┼─────┤                    ├─────┼─────┼─────┼─────┼─────┼─────┤
     TRNS, HASH, DLR,  LPRN, RPRN, GRAVE,                     DOWN, 4,    5,    6,    TRNS, _VOLDOWN,
  //├─────┼─────┼─────┼─────┼─────┼─────┼─────┐        ┌─────┼─────┼─────┼─────┼─────┼─────┼─────┤
     TRNS, LCTL, LALT, LBRC, RBRC, TILD, TRNS,          TRNS, AMPR, 1,    2,    3,    RALT, _MUTE,
  //└─────┴─────┴─────┴─┬───┴──┬──┴──┬──┴──┬──┘        └───┬─┴──┬──┴─┬───┴─┬───┴─────┴─────┴─────┘
                         LCTL, LALT, TRNS,                  LEFT,RGHT,  0
  //                    └──────┴─────┴─────┘               └────┴────┴─────┘
  ),

  [_GAMING] = LAYOUT(

  //┌────────┬────────┬────────┬────────┬────────┬────────┐                          ┌────────┬────────┬────────┬────────┬────────┬────────┐
     KC_ESC,  _______, _______, _______, _______, _______,                            _______, _______, _______, _______, _______, _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
     _______, KC_Q,    KC_W,    KC_E,    KC_R,    KC_T,                               KC_Y,    KC_U,    KC_I,    KC_O,    KC_P,    _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
     _______, KC_A,    KC_S,    KC_D,    KC_F,    KC_G,                               KC_H,    KC_J,    KC_K,    KC_L,    KC_SCLN, _______,
  //├────────┼────────┼────────┼────────┼────────┼────────┼────────┐        ┌────────┼────────┼────────┼────────┼────────┼────────┼────────┤
     _______, KC_Z,    KC_X,    KC_C,    KC_V,    KC_B,    _______,          _______, KC_M,    KC_M,    _______, _______, _______, _______,
  //└────────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘        └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
                                    _______, KC_SPC,  KC_SPC,                    KC_ENT,  KC_BSPC, _______
  //                               └────────┴────────┴────────┘                 └────────┴────────┴────────┘
  ),

  /*
  [_NAV] = LAYOUT(
  ┌────────┬────────┬────────┬────────┬────────┬────────┐                          ┌────────┬────────┬────────┬────────┬────────┬────────┐
  ├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
                     M↑
  ├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
            M←       M↓        M→                                                     ←        ↓        ↑        →
  ├────────┼────────┼────────┼────────┼────────┼────────┼────────┐        ┌────────┼────────┼────────┼────────┼────────┼────────┼────────┤
                     LCLK     RCLK
  └────────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘        └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
                                                                                        PGUP     PGDOWN
                                 └────────┴────────┴────────┘                 └────────┴────────┴────────┘
    _______, _______,  _______, _______, _______, _______,                            _______, _______, _______, _______, _______, _______,
    _______, _______,  _______, _______, _______, _______,                            _______, _______, _______, _______, _______, _______,
    _______, _______,  _______, _______, _______, _______,                            KC_LEFT, KC_DOWN, KC_UP,   KC_RIGHT,_______, _______,
    _______, _______,  _______, _______, _______, _______, _______,          _______, _______, _______, _______, _______, _______, _______,
                                   _______, _______, _______,                   _______, KC_PGUP, KC_PGDN
  )
  */

};

/*
  [_BLANK] = LAYOUT(
  ┌────────┬────────┬────────┬────────┬────────┬────────┐                          ┌────────┬────────┬────────┬────────┬────────┬────────┐
  ├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
  ├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤ 
  ├────────┼────────┼────────┼────────┼────────┼────────┼────────┐        ┌────────┼────────┼────────┼────────┼────────┼────────┼────────┤
  └────────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘        └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
                                 └────────┴────────┴────────┘                 └────────┴────────┴────────┘
     _______, _______, _______, _______, _______, _______,                            _______, _______, _______, _______, _______, _______,
     _______, _______, _______, _______, _______, _______,                            _______, _______, _______, _______, _______, _______,
     _______, _______, _______, _______, _______, _______,                            _______, _______, _______, _______, _______, _______,
     _______, _______, _______, _______, _______, _______,                            _______, _______, _______, _______, _______, _______,
                                    _______, _______, _______,                   _______, _______, _______
  ),
*/
/*
  [_PLOVER] = LAYOUT(
  ┌────────┬────────┬────────┬────────┬────────┬────────┐                          ┌────────┬────────┬────────┬────────┬────────┬────────┐
   EXT_PLOVER
  ├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
  ├────────┼────────┼────────┼────────┼────────┼────────┤                          ├────────┼────────┼────────┼────────┼────────┼────────┤
            S        T        P        H        *                                   *        F        P        L        T        D
  ├────────┼────────┼────────┼────────┼────────┼────────┼────────┐        ┌────────┼────────┼────────┼────────┼────────┼────────┼────────┤
            S        K        W        R        *                                   *        R        B        G        S        Z
  └────────┴────────┴────────┴───┬────┴───┬────┴───┬────┴───┬────┘        └───┬────┴───┬────┴───┬────┴───┬────┴────────┴────────┴────────┘
                                  A        O                                            E        U
                                 └────────┴────────┴────────┘                 └────────┴────────┴────────┘
    EXT_PLV, XXXXXXX, XXXXXXX, XXXXXXX, XXXXXXX, XXXXXXX,                            XXXXXXX, XXXXXXX, XXXXXXX, XXXXXXX, XXXXXXX, XXXXXXX,
    XXXXXXX, XXXXXXX, XXXXXXX, XXXXXXX, XXXXXXX, XXXXXXX,                            XXXXXXX, XXXXXXX, XXXXXXX, XXXXXXX, XXXXXXX, XXXXXXX,
    XXXXXXX, STN_S1, STN_TL, STN_PL, STN_HL, STN_ST1,                            STN_ST3, STN_FR, STN_PR , STN_LR , STN_TR , STN_DR ,
    XXXXXXX, STN_S2, STN_KL, STN_WL, STN_RL, STN_ST2, XXXXXXX,          XXXXXXX, STN_ST4, STN_RR, STN_BR , STN_GR , STN_SR , STN_ZR ,
                                  STN_A, STN_O, _______,                   _______, STN_E, STN_U
  ),
*/

// Tap dance GAMING toggle
int GAMINGlayer = 0;

void dance_qwerty_toggle (qk_tap_dance_state_t *state, void *user_data) {
  if (state->count >= 4) {
    if (GAMINGlayer == 1) {
      layer_off(_GAMING);
      GAMINGlayer = 0;
    } else {
      layer_on(_GAMING);
      GAMINGlayer = 1;
    }

    reset_tap_dance (state);
  } else {
    register_code(KC_LSFT);
  }
}

void dance_qwerty_reset (qk_tap_dance_state_t *state, void *user_data) {
  unregister_code (KC_LSFT);
}

qk_tap_dance_action_t tap_dance_actions[] = {
  [TD_LSFT]  = ACTION_TAP_DANCE_FN_ADVANCED(NULL, dance_qwerty_toggle, dance_qwerty_reset)
  // Other declarations would go here, separated by commas, if you have them
};
